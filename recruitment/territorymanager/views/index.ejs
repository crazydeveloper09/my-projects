
<%- include("partials/header") %>
   
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <h1 class="text-center">Witaj na Territory Manager</h1>
                <h4 class="text-center">
                    Wolne tereny zboru <%= currentUser.username %>
                </h4>
            </div>
        </div>
        <% if(territories.length===0){ %>
            <div class="row justify-content-center">
                <div class="col-lg-8 col-md-12">
                    <div class="alert alert-info text-center" role="alert">
                        Nie ma na razie wolnych terenów
                    </div>
                </div>
            </div>
        <% } else { %>
            <div class="row">
                <% for(let i=territories.length-1;i>=0;i--){ %>
                    <% if(typeof territories[i].preacher === 'undefined'){ %>
                        <div class="col-lg-6 col-md-12" style="margin-top: 8px;">
                                <div class="card">
                                    <div class="card-title text-center" id="name">
                                        <br>
                                        Karta terenu nr <%= territories[i].number %>
                                    </div>
                                        <div class="card-body">
                                           
                                            <p class="info">Miejscowość: <strong><%= territories[i].city %></strong></p>
                                            <p class="info">Ulica: 
                                                <strong><%= territories[i].street %> 
                                                    <% if(typeof territories[i].beginNumber !== 'undefined'){ %>
                                                        <%= territories[i].beginNumber %> 
                                                        <% if(typeof territories[i].endNumber !== 'undefined'){ %>
                                                            - <%= territories[i].endNumber %>
                                                        <% } %>
                                                    <% } %>
                                                </strong>
                                            </p>
                                            <% if(typeof territories[i].description !== 'undefined' && territories[i].description !== ''){ %>
                                                <p class="info">Opis: <strong><%= territories[i].description %></strong></p>
                                            <% } %>
                                            
                                            <% if(typeof territories[i].forbidden !== 'undefined' && territories[i].forbidden !== ''){ %>
                                                <p class="info">Nie zachodzić: <strong><%= territories[i].forbidden %></strong></p>
                                            <% } %>
                                            <p class="info">Ostatnio opracowane: <strong><%= territories[i].lastWorked %></strong></p>
                                            <p class="info"><strong>Teren nie był opracowywany od 
                                                    <% if(Math.round(Math.abs(new Date() - new Date(territories[i].lastWorked)) / 86400000) < 31){ %>
                                                        <%= Math.round(Math.abs(new Date() - new Date(territories[i].lastWorked)) / 86400000) %> dni
                                                    <% } else if(Math.round(Math.abs(new Date() - new Date(territories[i].lastWorked)) / 86400000) < 62){ %>
                                                        <span class="text-primary"><%= Math.round(Math.abs(new Date() - new Date(territories[i].lastWorked)) / 86400000) %></span> dni
                                                    <% } else if(Math.round(Math.abs(new Date() - new Date(territories[i].lastWorked)) / 86400000) < 93){ %>
                                                        <span class="text-orange" style="color: #fd7e14;"><%= Math.round(Math.abs(new Date() - new Date(territories[i].lastWorked)) / 86400000) %></span> dni
                                                    <% } else if(Math.round(Math.abs(new Date() - new Date(territories[i].lastWorked)) / 86400000) >= 124){ %>
                                                        <span class="text-danger"><%= Math.round(Math.abs(new Date() - new Date(territories[i].lastWorked)) / 86400000) %></span> dni
                                                        
                                                    <% } %>
                                            </strong></p>
                                            
                                            <p class="info"><strong>Teren oznaczony jako <span class="text-success">wolny</span></strong></p>
                                            <div class="d-inline">
                                                <a href="/territories/<%= territories[i]._id %>/edit" class="btn btn-primary">Edytuj</a>
                                                <a href="/territories/<%= territories[i]._id %>/delete" class="btn btn-danger">Usuń</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            
                    <% } %>
                    
                            
            
                <% } %>
            </div>
        <% } %>
        
<%- include("partials/footer") %>


